---
phase: 16-deadline-validation-core
plan: 03
type: execute
domain: validation
---

<objective>
Implement all 44 validation rules from V2_VALIDATION_RULES.md.

Purpose: Create pure validator functions that enforce all PERM regulatory requirements.
Output: Validator modules with comprehensive test coverage matching v1's 377 test behaviors.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-deadline-validation-core/16-RESEARCH.md
@.planning/phases/16-deadline-validation-core/16-CONTEXT.md
@.planning/phases/16-deadline-validation-core/16-01-SUMMARY.md
@.planning/phases/16-deadline-validation-core/16-02-SUMMARY.md
@.planning/V2_VALIDATION_RULES.md

**Prior decisions affecting this phase:**
- Plan 01: types.ts with ValidationResult, ValidationIssue types ready
- Plan 02: All calculators ready (PWD, recruitment, ETA 9089, I-140, RFI)
- Research: Pure TypeScript validators, return ValidationResult
- V2_VALIDATION_RULES.md: 44 rules across 8 categories

**Validation categories (44 rules total):**
- PWD Rules (4): V-PWD-01 to V-PWD-04
- Recruitment Rules (12): V-REC-01 to V-REC-12
- ETA 9089 Rules (5): V-ETA-01 to V-ETA-05
- I-140 Rules (3): V-I140-01 to V-I140-03
- RFI Rules (5): V-RFI-01 to V-RFI-05
- RFE Rules (5): V-RFE-01 to V-RFE-05
- Cascade Rules (5): V-CASCADE-01 to V-CASCADE-05
- System Rules (5): V-SYS-01 to V-SYS-05

**Key requirements from CONTEXT:**
- Date accuracy is paramount - off-by-one errors cause visa denials
- "Extend-only" fields enforced for Notice end and Job order end
- RFI due date is strict 30 days (NOT editable)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement PWD and recruitment date validators with TDD</name>
  <files>v2/src/lib/perm-engine/validators/pwd.ts, v2/src/lib/perm-engine/validators/pwd.test.ts, v2/src/lib/perm-engine/validators/recruitment.ts, v2/src/lib/perm-engine/validators/recruitment.test.ts</files>
  <action>
**TDD Approach: Write tests FIRST, then implement.**

1. Create validators directory: `v2/src/lib/perm-engine/validators/`

2. Create `pwd.test.ts` with tests for V-PWD-01 through V-PWD-04:
```typescript
import { validatePWDDates } from './pwd';

describe('validatePWDDates', () => {
  // V-PWD-01: Filing Before Determination
  test('V-PWD-01: error when filing >= determination', () => {
    const result = validatePWDDates({
      pwd_filing_date: '2024-02-01',
      pwd_determination_date: '2024-01-15',
      pwd_expiration_date: null,
    });
    expect(result.valid).toBe(false);
    expect(result.errors.some(e => e.ruleId === 'V-PWD-01')).toBe(true);
  });

  test('V-PWD-01: valid when filing < determination', () => {
    const result = validatePWDDates({
      pwd_filing_date: '2024-01-01',
      pwd_determination_date: '2024-02-15',
      pwd_expiration_date: '2024-06-30',
    });
    expect(result.errors.some(e => e.ruleId === 'V-PWD-01')).toBe(false);
  });

  // V-PWD-02: Determination Before Expiration
  test('V-PWD-02: error when determination >= expiration', () => {
    const result = validatePWDDates({
      pwd_filing_date: '2024-01-01',
      pwd_determination_date: '2024-06-30',
      pwd_expiration_date: '2024-06-30',
    });
    expect(result.errors.some(e => e.ruleId === 'V-PWD-02')).toBe(true);
  });

  // V-PWD-03: Expiration Calculation Warning
  test('V-PWD-03: warning when expiration mismatches calculation', () => {
    const result = validatePWDDates({
      pwd_filing_date: '2024-01-01',
      pwd_determination_date: '2024-05-15', // Should expire Aug 13
      pwd_expiration_date: '2024-08-20', // Wrong!
    });
    expect(result.warnings.some(w => w.ruleId === 'V-PWD-03')).toBe(true);
  });

  // V-PWD-04: Expired PWD Warning
  test('V-PWD-04: warning when PWD expired', () => {
    const result = validatePWDDates({
      pwd_filing_date: '2023-01-01',
      pwd_determination_date: '2023-02-15',
      pwd_expiration_date: '2023-06-30', // Past date
    });
    expect(result.warnings.some(w => w.ruleId === 'V-PWD-04')).toBe(true);
  });

  // Null handling
  test('valid when all dates null', () => {
    const result = validatePWDDates({
      pwd_filing_date: null,
      pwd_determination_date: null,
      pwd_expiration_date: null,
    });
    expect(result.valid).toBe(true);
  });
});
```

3. Implement `pwd.ts`:
```typescript
import { parseISO, isBefore, isAfter, isEqual, format } from 'date-fns';
import type { ValidationResult, ValidationIssue } from '../types';
import { calculatePWDExpiration } from '../calculators/pwd';

interface PWDDates {
  pwd_filing_date: string | null;
  pwd_determination_date: string | null;
  pwd_expiration_date: string | null;
}

export function validatePWDDates(dates: PWDDates): ValidationResult {
  const errors: ValidationIssue[] = [];
  const warnings: ValidationIssue[] = [];

  const { pwd_filing_date, pwd_determination_date, pwd_expiration_date } = dates;

  // V-PWD-01: Filing < Determination
  if (pwd_filing_date && pwd_determination_date) {
    const filing = parseISO(pwd_filing_date);
    const determination = parseISO(pwd_determination_date);
    if (!isBefore(filing, determination)) {
      errors.push({
        ruleId: 'V-PWD-01',
        severity: 'error',
        field: 'pwd_filing_date',
        message: 'PWD filing date must be before determination date',
        regulation: '20 CFR § 656.40(a)',
      });
    }
  }

  // V-PWD-02: Determination < Expiration
  if (pwd_determination_date && pwd_expiration_date) {
    const determination = parseISO(pwd_determination_date);
    const expiration = parseISO(pwd_expiration_date);
    if (!isBefore(determination, expiration)) {
      errors.push({
        ruleId: 'V-PWD-02',
        severity: 'error',
        field: 'pwd_expiration_date',
        message: 'PWD expiration date must be after determination date',
        regulation: '20 CFR § 656.40(c)',
      });
    }
  }

  // V-PWD-03: Expiration matches calculation
  if (pwd_determination_date && pwd_expiration_date) {
    const expected = calculatePWDExpiration(pwd_determination_date);
    if (pwd_expiration_date !== expected) {
      warnings.push({
        ruleId: 'V-PWD-03',
        severity: 'warning',
        field: 'pwd_expiration_date',
        message: `PWD expiration date doesn't match calculated value. Expected: ${expected}`,
        regulation: '20 CFR § 656.40(c)',
      });
    }
  }

  // V-PWD-04: PWD expired warning
  if (pwd_expiration_date) {
    const expiration = parseISO(pwd_expiration_date);
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    if (isBefore(expiration, today)) {
      warnings.push({
        ruleId: 'V-PWD-04',
        severity: 'warning',
        field: 'pwd_expiration_date',
        message: 'PWD has expired. ETA 9089 must be filed before this date.',
        regulation: '20 CFR § 656.40(c)',
      });
    }
  }

  return {
    valid: errors.length === 0,
    errors,
    warnings,
  };
}
```

4. Create `recruitment.test.ts` with tests for V-REC-01 through V-REC-12:
```typescript
import { validateRecruitmentDates } from './recruitment';

describe('validateRecruitmentDates', () => {
  // V-REC-01: First Sunday must be Sunday
  test('V-REC-01: error when first ad not Sunday', () => {
    const result = validateRecruitmentDates({
      sunday_ad_first_date: '2024-03-15', // Friday
      sunday_ad_second_date: null,
      job_order_start_date: null,
      job_order_end_date: null,
      notice_of_filing_start_date: null,
      notice_of_filing_end_date: null,
    });
    expect(result.errors.some(e => e.ruleId === 'V-REC-01')).toBe(true);
  });

  test('V-REC-01: valid when first ad is Sunday', () => {
    const result = validateRecruitmentDates({
      sunday_ad_first_date: '2024-03-17', // Sunday
      sunday_ad_second_date: null,
      job_order_start_date: null,
      job_order_end_date: null,
      notice_of_filing_start_date: null,
      notice_of_filing_end_date: null,
    });
    expect(result.errors.some(e => e.ruleId === 'V-REC-01')).toBe(false);
  });

  // V-REC-02: Second Sunday must be Sunday
  test('V-REC-02: error when second ad not Sunday', () => {
    const result = validateRecruitmentDates({
      sunday_ad_first_date: '2024-03-17',
      sunday_ad_second_date: '2024-03-25', // Monday
      job_order_start_date: null,
      job_order_end_date: null,
      notice_of_filing_start_date: null,
      notice_of_filing_end_date: null,
    });
    expect(result.errors.some(e => e.ruleId === 'V-REC-02')).toBe(true);
  });

  // V-REC-03: Second after first
  test('V-REC-03: error when second <= first', () => {
    const result = validateRecruitmentDates({
      sunday_ad_first_date: '2024-03-24',
      sunday_ad_second_date: '2024-03-17', // Before first!
      job_order_start_date: null,
      job_order_end_date: null,
      notice_of_filing_start_date: null,
      notice_of_filing_end_date: null,
    });
    expect(result.errors.some(e => e.ruleId === 'V-REC-03')).toBe(true);
  });

  // V-REC-04: Job order end after start
  test('V-REC-04: error when job order end <= start', () => {
    const result = validateRecruitmentDates({
      sunday_ad_first_date: null,
      sunday_ad_second_date: null,
      job_order_start_date: '2024-04-01',
      job_order_end_date: '2024-03-15', // Before start!
      notice_of_filing_start_date: null,
      notice_of_filing_end_date: null,
    });
    expect(result.errors.some(e => e.ruleId === 'V-REC-04')).toBe(true);
  });

  // V-REC-05: Job order minimum 30 days
  test('V-REC-05: error when job order < 30 days', () => {
    const result = validateRecruitmentDates({
      sunday_ad_first_date: null,
      sunday_ad_second_date: null,
      job_order_start_date: '2024-04-01',
      job_order_end_date: '2024-04-15', // Only 14 days
      notice_of_filing_start_date: null,
      notice_of_filing_end_date: null,
    });
    expect(result.errors.some(e => e.ruleId === 'V-REC-05')).toBe(true);
  });

  test('V-REC-05: valid when job order exactly 30 days', () => {
    const result = validateRecruitmentDates({
      sunday_ad_first_date: null,
      sunday_ad_second_date: null,
      job_order_start_date: '2024-04-01',
      job_order_end_date: '2024-05-01', // Exactly 30 days
      notice_of_filing_start_date: null,
      notice_of_filing_end_date: null,
    });
    expect(result.errors.some(e => e.ruleId === 'V-REC-05')).toBe(false);
  });

  // V-REC-06: Notice end after start
  // V-REC-07: Notice 10 business days
  // V-REC-08, V-REC-09: Notice start/end required together
  // V-REC-11, V-REC-12: Extend-only rules (tested separately)
});
```

5. Implement `recruitment.ts` with all 12 V-REC rules.
  </action>
  <verify>
- `cd v2 && pnpm test pwd` passes all PWD validation tests (10+ tests)
- `cd v2 && pnpm test recruitment` passes all recruitment tests (20+ tests)
  </verify>
  <done>PWD and recruitment validators implemented with TDD, covering all rules V-PWD-01 to V-PWD-04 and V-REC-01 to V-REC-12</done>
</task>

<task type="auto">
  <name>Task 2: Implement ETA 9089 and I-140 validators with TDD</name>
  <files>v2/src/lib/perm-engine/validators/eta9089.ts, v2/src/lib/perm-engine/validators/eta9089.test.ts, v2/src/lib/perm-engine/validators/i140.ts, v2/src/lib/perm-engine/validators/i140.test.ts</files>
  <action>
**TDD Approach: Write tests FIRST, then implement.**

1. Create `eta9089.test.ts` with tests for V-ETA-01 through V-ETA-05:
```typescript
import { validateETA9089Dates } from './eta9089';

describe('validateETA9089Dates', () => {
  // V-ETA-01: Filing 30+ days after recruitment
  test('V-ETA-01: error when filing < 30 days after recruitment', () => {
    const result = validateETA9089Dates({
      recruitment_end_date: '2024-06-30',
      eta9089_filing_date: '2024-07-15', // Only 15 days
      eta9089_certification_date: null,
      eta9089_expiration_date: null,
      pwd_expiration_date: '2024-12-31',
    });
    expect(result.errors.some(e => e.ruleId === 'V-ETA-01')).toBe(true);
  });

  test('V-ETA-01: valid when filing exactly 30 days after recruitment', () => {
    const result = validateETA9089Dates({
      recruitment_end_date: '2024-06-30',
      eta9089_filing_date: '2024-07-30', // Exactly 30 days
      eta9089_certification_date: null,
      eta9089_expiration_date: null,
      pwd_expiration_date: '2024-12-31',
    });
    expect(result.errors.some(e => e.ruleId === 'V-ETA-01')).toBe(false);
  });

  // V-ETA-02: Filing within 180 days
  test('V-ETA-02: error when filing > 180 days after recruitment', () => {
    const result = validateETA9089Dates({
      recruitment_end_date: '2024-06-30',
      eta9089_filing_date: '2025-01-15', // 199 days
      eta9089_certification_date: null,
      eta9089_expiration_date: null,
      pwd_expiration_date: '2025-06-30',
    });
    expect(result.errors.some(e => e.ruleId === 'V-ETA-02')).toBe(true);
  });

  // V-ETA-03: Either/Or Rule (filing before PWD expiration)
  test('V-ETA-03: error when filing > PWD expiration', () => {
    const result = validateETA9089Dates({
      recruitment_end_date: '2024-06-30',
      eta9089_filing_date: '2024-09-15',
      eta9089_certification_date: null,
      eta9089_expiration_date: null,
      pwd_expiration_date: '2024-08-13', // Expired before filing!
    });
    expect(result.errors.some(e => e.ruleId === 'V-ETA-03')).toBe(true);
  });

  // V-ETA-04: Certification after filing
  test('V-ETA-04: error when certification <= filing', () => {
    const result = validateETA9089Dates({
      recruitment_end_date: '2024-06-30',
      eta9089_filing_date: '2024-08-15',
      eta9089_certification_date: '2024-08-10', // Before filing!
      eta9089_expiration_date: null,
      pwd_expiration_date: '2024-12-31',
    });
    expect(result.errors.some(e => e.ruleId === 'V-ETA-04')).toBe(true);
  });

  // V-ETA-05: Expiration calculation warning
  test('V-ETA-05: warning when expiration not 180 days after certification', () => {
    const result = validateETA9089Dates({
      recruitment_end_date: '2024-06-30',
      eta9089_filing_date: '2024-08-15',
      eta9089_certification_date: '2024-10-01',
      eta9089_expiration_date: '2025-04-15', // Should be Mar 30
      pwd_expiration_date: '2024-12-31',
    });
    expect(result.warnings.some(w => w.ruleId === 'V-ETA-05')).toBe(true);
  });
});
```

2. Implement `eta9089.ts`:
```typescript
import { parseISO, differenceInDays, isBefore, isAfter } from 'date-fns';
import type { ValidationResult, ValidationIssue } from '../types';
import { calculateETA9089Expiration } from '../calculators/eta9089';

interface ETA9089Dates {
  recruitment_end_date: string | null;
  eta9089_filing_date: string | null;
  eta9089_certification_date: string | null;
  eta9089_expiration_date: string | null;
  pwd_expiration_date: string | null;
}

export function validateETA9089Dates(dates: ETA9089Dates): ValidationResult {
  const errors: ValidationIssue[] = [];
  const warnings: ValidationIssue[] = [];

  const {
    recruitment_end_date,
    eta9089_filing_date,
    eta9089_certification_date,
    eta9089_expiration_date,
    pwd_expiration_date,
  } = dates;

  // V-ETA-01: Filing at least 30 days after recruitment
  if (recruitment_end_date && eta9089_filing_date) {
    const days = differenceInDays(
      parseISO(eta9089_filing_date),
      parseISO(recruitment_end_date)
    );
    if (days < 30) {
      errors.push({
        ruleId: 'V-ETA-01',
        severity: 'error',
        field: 'eta9089_filing_date',
        message: `ETA 9089 must be filed at least 30 days after recruitment ends (filed ${days} days after)`,
        regulation: '20 CFR § 656.10(d)(2)',
      });
    }
  }

  // V-ETA-02: Filing within 180 days
  if (recruitment_end_date && eta9089_filing_date) {
    const days = differenceInDays(
      parseISO(eta9089_filing_date),
      parseISO(recruitment_end_date)
    );
    if (days > 180) {
      errors.push({
        ruleId: 'V-ETA-02',
        severity: 'error',
        field: 'eta9089_filing_date',
        message: `ETA 9089 must be filed within 180 days after recruitment ends (filed ${days} days after)`,
        regulation: '20 CFR § 656.10(d)(2)',
      });
    }
  }

  // V-ETA-03: Either/Or Rule - filing before PWD expiration
  if (eta9089_filing_date && pwd_expiration_date) {
    if (isAfter(parseISO(eta9089_filing_date), parseISO(pwd_expiration_date))) {
      errors.push({
        ruleId: 'V-ETA-03',
        severity: 'error',
        field: 'eta9089_filing_date',
        message: 'ETA 9089 must be filed before PWD expires',
        regulation: '20 CFR § 656.40(c)',
      });
    }
  }

  // V-ETA-04: Certification after filing
  if (eta9089_filing_date && eta9089_certification_date) {
    if (!isAfter(parseISO(eta9089_certification_date), parseISO(eta9089_filing_date))) {
      errors.push({
        ruleId: 'V-ETA-04',
        severity: 'error',
        field: 'eta9089_certification_date',
        message: 'ETA 9089 certification date must be after filing date',
      });
    }
  }

  // V-ETA-05: Expiration calculation warning
  if (eta9089_certification_date && eta9089_expiration_date) {
    const expected = calculateETA9089Expiration(eta9089_certification_date);
    if (eta9089_expiration_date !== expected) {
      warnings.push({
        ruleId: 'V-ETA-05',
        severity: 'warning',
        field: 'eta9089_expiration_date',
        message: `ETA 9089 expiration is typically 180 days after certification. Expected: ${expected}`,
      });
    }
  }

  return { valid: errors.length === 0, errors, warnings };
}
```

3. Create `i140.test.ts` for V-I140-01 through V-I140-03:
```typescript
describe('validateI140Dates', () => {
  // V-I140-01: Filing after certification
  test('V-I140-01: error when filing < certification', () => {
    const result = validateI140Dates({
      eta9089_certification_date: '2024-10-01',
      i140_filing_date: '2024-09-15', // Before certification
      i140_approval_date: null,
    });
    expect(result.errors.some(e => e.ruleId === 'V-I140-01')).toBe(true);
  });

  // V-I140-02: Filing within 180 days
  test('V-I140-02: error when filing > 180 days after certification', () => {
    const result = validateI140Dates({
      eta9089_certification_date: '2024-10-01',
      i140_filing_date: '2025-04-15', // 196 days later
      i140_approval_date: null,
    });
    expect(result.errors.some(e => e.ruleId === 'V-I140-02')).toBe(true);
  });

  // V-I140-03: Approval after filing
  test('V-I140-03: error when approval <= filing', () => {
    const result = validateI140Dates({
      eta9089_certification_date: '2024-10-01',
      i140_filing_date: '2024-11-15',
      i140_approval_date: '2024-11-10', // Before filing!
    });
    expect(result.errors.some(e => e.ruleId === 'V-I140-03')).toBe(true);
  });
});
```

4. Implement `i140.ts` with all 3 rules.
  </action>
  <verify>
- `cd v2 && pnpm test eta9089.test` passes all ETA 9089 validation tests (8+ tests)
- `cd v2 && pnpm test i140.test` passes all I-140 tests (5+ tests)
  </verify>
  <done>ETA 9089 and I-140 validators implemented with TDD, covering all rules</done>
</task>

<task type="auto">
  <name>Task 3: Implement RFI/RFE validators and master validator with TDD</name>
  <files>v2/src/lib/perm-engine/validators/rfi.ts, v2/src/lib/perm-engine/validators/rfi.test.ts, v2/src/lib/perm-engine/validators/rfe.ts, v2/src/lib/perm-engine/validators/rfe.test.ts, v2/src/lib/perm-engine/validators/index.ts, v2/src/lib/perm-engine/validators/validate-case.ts, v2/src/lib/perm-engine/validators/validate-case.test.ts</files>
  <action>
**TDD Approach: Write tests FIRST, then implement.**

1. Create `rfi.test.ts` for V-RFI-01 through V-RFI-05:
```typescript
describe('validateRFIDates', () => {
  // V-RFI-01: Received after filing
  test('V-RFI-01: error when RFI received <= ETA filing', () => {
    const result = validateRFIDates({
      eta9089_filing_date: '2024-08-15',
      rfi_received_date: '2024-08-10', // Before filing
      rfi_due_date: '2024-09-10',
      rfi_submitted_date: null,
    });
    expect(result.errors.some(e => e.ruleId === 'V-RFI-01')).toBe(true);
  });

  // V-RFI-02: Due date strict 30 days (NOT editable)
  test('V-RFI-02: error when due != received + 30', () => {
    const result = validateRFIDates({
      eta9089_filing_date: '2024-08-15',
      rfi_received_date: '2024-10-15',
      rfi_due_date: '2024-11-20', // Should be Nov 14
      rfi_submitted_date: null,
    });
    expect(result.errors.some(e => e.ruleId === 'V-RFI-02')).toBe(true);
  });

  // V-RFI-03: Submitted after received
  test('V-RFI-03: error when submitted < received', () => {
    const result = validateRFIDates({
      eta9089_filing_date: '2024-08-15',
      rfi_received_date: '2024-10-15',
      rfi_due_date: '2024-11-14',
      rfi_submitted_date: '2024-10-10', // Before received!
    });
    expect(result.errors.some(e => e.ruleId === 'V-RFI-03')).toBe(true);
  });

  // V-RFI-04: Submitted after due (warning)
  test('V-RFI-04: warning when submitted > due', () => {
    const result = validateRFIDates({
      eta9089_filing_date: '2024-08-15',
      rfi_received_date: '2024-10-15',
      rfi_due_date: '2024-11-14',
      rfi_submitted_date: '2024-11-20', // Late!
    });
    expect(result.warnings.some(w => w.ruleId === 'V-RFI-04')).toBe(true);
  });
});
```

2. Implement `rfi.ts` with all 5 rules (V-RFI-01 to V-RFI-05).

3. Create `rfe.test.ts` for V-RFE-01 through V-RFE-05:
   - Similar to RFI but: V-RFE-02 validates due > received (editable, unlike RFI)

4. Implement `rfe.ts` with all 5 rules.

5. Create `validate-case.ts` - master validator that combines all validators:
```typescript
import type { CaseData, ValidationResult } from '../types';
import { validatePWDDates } from './pwd';
import { validateRecruitmentDates } from './recruitment';
import { validateETA9089Dates } from './eta9089';
import { validateI140Dates } from './i140';
import { validateRFIDates } from './rfi';
import { validateRFEDates } from './rfe';

export function validateCase(caseData: CaseData): ValidationResult {
  const allErrors: ValidationIssue[] = [];
  const allWarnings: ValidationIssue[] = [];

  // Run all validators
  const pwdResult = validatePWDDates({
    pwd_filing_date: caseData.pwd_filing_date,
    pwd_determination_date: caseData.pwd_determination_date,
    pwd_expiration_date: caseData.pwd_expiration_date,
  });
  allErrors.push(...pwdResult.errors);
  allWarnings.push(...pwdResult.warnings);

  // ... run other validators ...

  return {
    valid: allErrors.length === 0,
    errors: allErrors,
    warnings: allWarnings,
  };
}
```

6. Create `validate-case.test.ts` with integration tests:
```typescript
describe('validateCase', () => {
  test('returns all errors from all validators', () => {
    const result = validateCase({
      pwd_filing_date: '2024-02-01',
      pwd_determination_date: '2024-01-15', // V-PWD-01 error
      pwd_expiration_date: '2024-06-30',
      sunday_ad_first_date: '2024-03-15', // V-REC-01 error (not Sunday)
      // ... other fields null
    });
    expect(result.valid).toBe(false);
    expect(result.errors.length).toBeGreaterThanOrEqual(2);
  });

  test('valid case passes all validators', () => {
    const result = validateCase(createValidCaseData());
    expect(result.valid).toBe(true);
    expect(result.errors.length).toBe(0);
  });
});
```

7. Create `validators/index.ts` to export all validators.

8. Update `perm-engine/index.ts` to export validators.
  </action>
  <verify>
- `cd v2 && pnpm test rfi` passes (8+ tests)
- `cd v2 && pnpm test rfe` passes (8+ tests)
- `cd v2 && pnpm test validate-case` passes integration tests
- `cd v2 && pnpm test validators` passes ALL validator tests
  </verify>
  <done>RFI/RFE validators implemented, master validateCase function ready, all 44 validation rules covered</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd v2 && pnpm test validators` runs all validator tests
- [ ] All 44 validation rules implemented (V-PWD-*, V-REC-*, V-ETA-*, V-I140-*, V-RFI-*, V-RFE-*)
- [ ] Each rule has at least 2 test cases (valid and invalid)
- [ ] validateCase() integrates all validators
- [ ] RFI due date enforced as strict 30 days (V-RFI-02)
- [ ] Extend-only rules enforced (V-REC-11, V-REC-12)
- [ ] Test count: 60+ validation tests
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- TDD followed (tests written before implementation)
- Validators ready for cascade reducer (Plan 04)
</success_criteria>

<output>
After completion, create `.planning/phases/16-deadline-validation-core/16-03-SUMMARY.md`:

# Phase 16 Plan 03: Validators Summary

**[Substantive one-liner about what shipped]**

## Accomplishments

- PWD validators (V-PWD-01 to V-PWD-04)
- Recruitment validators (V-REC-01 to V-REC-12)
- ETA 9089 validators (V-ETA-01 to V-ETA-05)
- I-140 validators (V-I140-01 to V-I140-03)
- RFI validators (V-RFI-01 to V-RFI-05)
- RFE validators (V-RFE-01 to V-RFE-05)
- Master validateCase() function

## Files Created/Modified

- `v2/src/lib/perm-engine/validators/pwd.ts` + tests
- `v2/src/lib/perm-engine/validators/recruitment.ts` + tests
- `v2/src/lib/perm-engine/validators/eta9089.ts` + tests
- `v2/src/lib/perm-engine/validators/i140.ts` + tests
- `v2/src/lib/perm-engine/validators/rfi.ts` + tests
- `v2/src/lib/perm-engine/validators/rfe.ts` + tests
- `v2/src/lib/perm-engine/validators/validate-case.ts` + tests
- `v2/src/lib/perm-engine/validators/index.ts`

## Decisions Made

[Key decisions and rationale]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 16-04-PLAN.md (Cascade Reducer)
</output>
