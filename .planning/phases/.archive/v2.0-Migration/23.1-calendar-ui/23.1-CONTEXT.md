# Phase 23.1: Calendar View Page - Context

**Gathered:** 2025-12-28
**Status:** Ready for planning

<vision>
## How This Should Work

When users go to the Calendar page, they see ALL their cases' deadlines displayed on a beautiful calendar - not just the ones synced to Google Calendar. It's the in-app view of everything happening across their caseload.

The calendar should feel like opening a well-designed scheduling app - month view is primary, with week and day views for drilling down. Events are color-coded by case stage (PWD blue, Recruitment purple, ETA orange, I-140 green) so at a glance you know what's what.

Hovering over an event shows the full case details - employer name, beneficiary, position, deadline type. Clicking navigates to the case. It should feel snappy and reactive, with the same neobrutalist polish as the rest of v2.

Copy the v1 calendar look (it's nice) but with v2 improvements - creative animations, better interactions, more responsive. Everything should feel on-theme with the hard shadows, bold borders, Space Grotesk typography.

</vision>

<essential>
## What Must Be Nailed

- **All cases visible** - The in-app calendar shows ALL cases, regardless of Google Calendar sync status. Google sync is separate - this is your complete view.

- **Stage-colored events** - Instant visual recognition of deadline types through consistent color coding (PWD blue, Recruitment purple, ETA orange, I-140 green, urgency red/orange/green).

- **Visibility controls** - Users can hide specific cases, specific deadline types, or specific case+deadline combos from the calendar. "Show hidden" toggle reveals what's hidden. This keeps the calendar uncluttered for users with many cases.

- **Completed cases filtered by default** - Don't clutter with done cases, but provide toggle to show them if wanted.

- **Filing windows as markers** - Show "ETA Window Opens" and "ETA Window Closes" as separate events, not confusing spans.

</essential>

<boundaries>
## What's Out of Scope

- **Google Calendar sync** - That's Phase 30. We're building the in-app calendar only. The infrastructure for Google sync will come later.
- **Settings UI for calendar preferences** - That's Phase 25. For now, visibility controls are inline (click to hide, show hidden toggle).
- **Drag-to-reschedule** - Deadlines are calculated from case data, not manually set. Skip this complexity.
- **Notifications** - That's Phase 24. Calendar just displays, doesn't alert.
- **Two-way sync** - Phase 30 handles webhooks from Google Calendar back to app.

</boundaries>

<specifics>
## Specific Ideas

**Library:** Use `react-big-calendar` (not custom grid like v1) - faster to build, handles event positioning/overlaps, date-fns adapter available. Style it to match neobrutalist design system.

**Views:** Month (default), week, day. Navigation buttons, "Today" button.

**Event display:**
- Abbreviated names: "PWD Exp: Smith J."
- Full details on hover: "PWD Expiration - John Smith (Case #123)"
- Stage color as background or left border
- Urgency indicator (red/orange/green dot) for time-sensitive

**Visibility controls:**
- Click event → dropdown → "Hide this deadline" / "Hide all [Case Name] deadlines"
- Filter bar with deadline type checkboxes
- "Show hidden" toggle or "Hidden (3)" badge that expands
- Case status filter (show/hide by stage)

**Visual indicators:**
- Google sync status badge (placeholder for Phase 30 - shows which cases are synced)
- Today highlighted
- Weekend columns slightly different background

**Responsive:** Mobile may need list view fallback since calendars are hard on small screens.

</specifics>

<notes>
## Additional Context

**From v1 implementation:**
- v1 uses custom 7-column grid with dayjs + Tippy.js tooltips
- Neobrutalist styling already established
- Event colors match case stages
- Hover shows case summary (employer, position, status)

**Data model for visibility:**
```typescript
// Proposed additions to userProfiles or separate calendarPreferences
calendarHiddenCases: v.optional(v.array(v.id("cases"))),
calendarHiddenDeadlineTypes: v.optional(v.array(v.string())),
calendarHiddenSpecific: v.optional(v.array(v.object({
  caseId: v.id("cases"),
  deadlineType: v.string()
})))
```

**Design references:**
- Design system in `v2/docs/DESIGN_SYSTEM.md`
- Design tokens in `.planning/V2_DESIGN_TOKENS.json`
- Design examples in `.planning/phases/17-design-system/design1-5`
- frontend-design skill (its a plug-in) in `.planning/FRONTEND_DESIGN_SKILL.md`

**User guidelines for implementation:**
- Copy v1 but with improvements and v2 polish
- DRY/KISS - minimal, simple, use existing code/patterns
- No clashing implementations - work within existing, seamless
- Refactor as needed for fixes or future-proofing
- Use Explore agents throughout to preserve context
- Follow perm_flow.md for business logic
- All subagents get full instructions (design skill, docs, context)

**Human checkpoint:** This is a UI phase - requires visual review before completion.

</notes>

---

*Phase: 23.1-calendar-ui*
*Context gathered: 2025-12-28*
