---
phase: 17.1-improve-designs
plan: 01
type: execute
domain: frontend-design
---

<objective>
Add core visual polish: badge 3D shadows, grain overlay, dot background pattern, and mono typography utility.

Purpose: Close the gap between Phase 17 components and the design references (especially design4) with foundational CSS improvements.
Output: Updated globals.css with grain overlay, dot background, and .mono utility. Badges updated with 3D shadow effect.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/FRONTEND_DESIGN_SKILL.md
@.planning/phases/17.1-improve-designs/17.1-CONTEXT.md

**MANDATORY FOR ALL SUBAGENTS:**
Every subagent executing tasks in this plan MUST read the following before implementation:

1. **frontend-design skill (its a plug-in):** @.planning/FRONTEND_DESIGN_SKILL.md
2. **All design references:**
   - @.planning/phases/17-design-system/design1 (Tectonic UI - slab shadows, mesh backgrounds)
   - @.planning/phases/17-design-system/design2 (Modular Assembly - grain overlay, skeleton shimmer)
   - @.planning/phases/17-design-system/design3 (Brainstorming - skeleton states, animations)
   - @.planning/phases/17-design-system/design4 (PERM Progression - stage tags, hover effects) **PRIMARY**
   - @.planning/phases/17-design-system/design5 (PERM Tracker Core - hazard stripes, glass panels)

**Current implementation files:**
@v2/src/app/globals.css
@v2/src/components/ui/badge.tsx
@v2/src/components/status/progress-status-badge.tsx
@v2/src/components/status/case-stage-badge.tsx

**Prior decisions affecting this phase:**
- Phase 17 established neobrutalist aesthetic with Space Grotesk + Inter + JetBrains Mono
- CSS variables for shadows already exist: --shadow-hard-sm (2px), --shadow-hard (4px), --shadow-hard-lg (8px)
- All badges use border-2 border-border styling

**What we're NOT changing:**
- Core color palette (already matches v1 status colors)
- Component structure (just adding visual polish)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add grain overlay to globals.css</name>
  <files>v2/src/app/globals.css</files>
  <action>
    Add the grain overlay CSS from design4:

    1. In @layer utilities section, add:
    ```css
    .grain-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9999;
      opacity: 0.04;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
    }
    ```

    2. Add dot/mesh background utility:
    ```css
    .bg-dots {
      background-image: radial-gradient(rgba(0,0,0,0.05) 1px, transparent 1px);
      background-size: 24px 24px;
    }
    ```

    3. Add .mono utility class for JetBrains Mono:
    ```css
    .mono {
      font-family: var(--font-mono);
    }
    ```

    NOTE: These are additive changes. Do not remove existing CSS.
  </action>
  <verify>grep -E "(grain-overlay|bg-dots|\.mono)" v2/src/app/globals.css should show all three utilities</verify>
  <done>Three new utility classes added: .grain-overlay, .bg-dots, .mono</done>
</task>

<task type="auto">
  <name>Task 2: Add shadow-hard-sm to all badges</name>
  <files>v2/src/components/ui/badge.tsx</files>
  <action>
    Update the badge base styles to include the 3D shadow effect:

    In badgeVariants cva() base string, add:
    - shadow-hard-sm (which maps to box-shadow: 2px 2px 0px #000)

    Find the current base string that starts with:
    "inline-flex items-center justify-center border-2..."

    Add "shadow-hard-sm" to give badges the neobrutalist 3D pop.

    The shadow utility is already defined in globals.css, so this should work immediately.
  </action>
  <verify>grep "shadow-hard-sm" v2/src/components/ui/badge.tsx should find the class</verify>
  <done>Badge component has 3D shadow effect matching design references</done>
</task>

<task type="auto">
  <name>Task 3: Add grain overlay to layout</name>
  <files>v2/src/app/layout.tsx</files>
  <exploration>
    Check current layout structure to find the best place to add grain overlay div.
    The grain overlay should be a fixed element that covers the entire viewport.
  </exploration>
  <action>
    Add the grain overlay div to the root layout, just inside the body tag after the main content wrapper:

    Add: `<div className="grain-overlay" aria-hidden="true" />`

    This should be:
    - After all page content (so z-index stacking works)
    - aria-hidden="true" for accessibility (decorative element)

    If layout uses ThemeProvider or similar wrappers, place the grain div at the same level as the children.
  </action>
  <verify>grep "grain-overlay" v2/src/app/layout.tsx should find the div</verify>
  <done>Grain overlay applied globally via root layout</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` in v2/ succeeds without errors
- [ ] `npm run storybook` builds successfully
- [ ] Grain overlay, bg-dots, and .mono utilities exist in globals.css
- [ ] Badge component includes shadow-hard-sm class
- [ ] Grain overlay div added to root layout
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- No regressions in existing components
- Visual polish foundations ready for next plan
</success_criteria>

<output>
After completion, create `.planning/phases/17.1-improve-designs/17.1-01-SUMMARY.md`:

# Phase 17.1 Plan 01: Core Visual Polish Summary

**[One-liner describing what shipped]**

## Accomplishments
- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified
- `path/to/file.ts` - Description

## Decisions Made
[Key decisions and rationale, or "None"]

## Issues Encountered
[Problems and resolutions, or "None"]

## Next Step
Ready for 17.1-02-PLAN.md (Skeleton component + Stage progression)
</output>
