---
phase: 28-action-layer
task: 3 (FIXED)
total_tasks: 5 (estimated)
status: ready_for_next
last_updated: 2026-01-09T16:30:00Z
---

<current_state>
28-03 issues have been FIXED:
- archiveCase now **closes** the case (sets `caseStatus: "closed"`) instead of deleting
- restoreCase tool has been **removed** (redundant with reopenCase)
- deleteCase calls `api.cases.remove` which now performs **hard delete** with full cascade cleanup

The cases.remove and cases.bulkRemove mutations have been updated to:
- HARD DELETE (actually remove from database, not soft delete)
- Full cascade cleanup: notifications, calendar events, userCaseOrder, timelinePreferences, dismissedDeadlines, conversations, conversationMessages
</current_state>

<completed_work>
**28-03 FIXES:**
1. ✅ Fixed archiveCase tool - now closes case instead of soft delete
   - Updated tool description in tools.ts
   - Updated route.ts handler to call api.cases.update with caseStatus: "closed"

2. ✅ Removed restoreCase tool entirely
   - Removed from tools.ts (schema, type, tool definition, chatTools export)
   - Removed from index.ts exports
   - Removed from tool-permissions.ts
   - Removed from tool-icons.tsx
   - Removed from tool-result-summary.ts
   - Removed from route.ts handler

3. ✅ Hard delete implementation
   - cases.remove now performs hard delete with full cascade cleanup
   - cases.bulkRemove updated to hard delete
   - Removed restore mutation from cases.ts

4. ✅ Documentation updates
   - Updated API.md to reflect hard delete behavior
   - Removed restore mutation documentation
</completed_work>

<remaining_work>
**Phase 28 remaining plans:**
- 28-04-PLAN.md (Calendar, Notifications & Settings Tools) - needs planning
- 28-05-PLAN.md - needs planning

**Next steps:**
1. Plan 28-04: Calendar, Notifications & Settings Tools
2. Plan 28-05: (TBD based on scope)
3. Complete Phase 28 execution
</remaining_work>

<decisions_made>
- ✅ archiveCase = close case (caseStatus: "closed")
- ✅ deleteCase = hard delete (actually removes from DB)
- ✅ restoreCase = removed (use reopenCase for closed cases)
- ✅ Permission levels: autonomous/confirm/destructive (unchanged)
- ✅ deleteCase always requires confirmation regardless of actionMode
</decisions_made>

<blockers>
None - ready to proceed with 28-04 planning
</blockers>

<next_action>
Continue to 28-04-PLAN.md (Calendar, Notifications & Settings Tools) or plan the remaining Phase 28 work.
</next_action>
