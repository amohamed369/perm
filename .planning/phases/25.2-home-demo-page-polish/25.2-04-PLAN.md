---
phase: 25.2-home-demo-page-polish
plan: 04
type: execute
---

<objective>
Build demo page core infrastructure: banner, stats grid, mini calendar, mini timeline, and localStorage utilities.

Purpose: Create interactive demo foundation for showcasing the product without authentication.
Output: Demo page at /demo with stats, calendar, timeline - all powered by localStorage.
</objective>

<CASCADING_CONTEXT>
## Instructions for All Agents, Plans, and Execution

### Core Philosophy
- **DRY, KISS** — No duplication, minimal complexity
- **Performance first** — Fast loading is critical, animations must be lightweight
- **Work within existing patterns** — Use v2 design system as-is, no new tokens
- **Explore first** — Fully understand before implementing
- **No clashing implementations** — Seamless integration with existing code

### Required Reading (MUST read before any implementation)
1. `.planning/FRONTEND_DESIGN_SKILL.md` — Frontend design patterns
2. `.planning/phases/17-design-system/design*` — Design docs 1-4
3. `perm_flow.md` — Case statuses, progress statuses, stage transitions
4. `v2/src/app/globals.css` — Existing animations and utilities
5. `v2/src/components/ui/` — Existing component patterns

### Implementation Rules
1. Use existing CSS animation utilities from globals.css
2. No new colors, shadows, or typography tokens
3. No new border-radius (system is square-corners only)
4. Keep code clean, organized, maintainable, readable
5. Ensure no clashing or duplicate implementations
6. Make fixes global — don't repeat patterns
7. Refactor as needed to fit fixes or improve maintainability
8. Abstract-able, scalable, DRY throughout

### Performance Requirements
- Animations must be CSS-based where possible (not JS-driven)
- Lazy load heavy components
- Optimize images (use next/image)
- Reduce motion on mobile for battery/performance
- Code split aggressively
- No blocking renders

### Quality Standards
- All features from v1 must be preserved
- Mobile responsive on all pages
- Dark mode support
- Touch-optimized on mobile
- Accessibility (ARIA labels, keyboard nav)
</CASCADING_CONTEXT>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/FRONTEND_DESIGN_SKILL.md
@.planning/phases/25.2-home-demo-page-polish/25.2-CONTEXT.md
@.planning/phases/25.2-home-demo-page-polish/25.2-03-SUMMARY.md
@frontend/demo.html

**Prior context:**
- 25.2-01 to 25.2-03: Home page complete
- (public) route group established

**V1 demo features to preserve:**
- Demo banner (fixed, gradient)
- Stats grid (4 cards)
- Mini calendar with event dots
- Mini timeline with progress bars
- 5 default demo cases
- Reset demo functionality

**Key technical decisions:**
- localStorage for demo case persistence (no Convex)
- Client component ("use client") for interactivity
- Use PERM business logic from @/lib/perm for calculations
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create demo localStorage utilities and default cases</name>
  <files>v2/src/lib/demo/storage.ts, v2/src/lib/demo/defaultCases.ts, v2/src/lib/demo/types.ts</files>
  <exploration>
    Review v1 demo.html JavaScript for localStorage patterns.
    Check PERM business logic exports from @/lib/perm.
    Look at CaseData type structure.
  </exploration>
  <action>
    Create demo utilities in v2/src/lib/demo/:

    1. types.ts - Demo case type (subset of full CaseData):
       ```typescript
       export interface DemoCase {
         id: string;
         beneficiaryName: string;
         employerName: string;
         status: CaseStatus;
         progressStatus: ProgressStatus;
         pwdFilingDate?: string;
         pwdDeterminationDate?: string;
         pwdExpirationDate?: string;
         // ... other key fields
         createdAt: string;
         updatedAt: string;
       }
       ```

    2. storage.ts - localStorage CRUD:
       - DEMO_CASES_KEY = 'perm-tracker-demo-cases'
       - getDemoCases(): DemoCase[]
       - setDemoCases(cases: DemoCase[]): void
       - addDemoCase(case: Omit<DemoCase, 'id' | 'createdAt' | 'updatedAt'>): DemoCase
       - updateDemoCase(id: string, updates: Partial<DemoCase>): DemoCase | null
       - deleteDemoCase(id: string): boolean
       - resetDemoCases(): void (restores defaults)
       - initDemoCases(): void (initializes if empty)
       - Hook: useDemoCases() - React hook with state sync

    3. defaultCases.ts - 5 default demo cases:
       - Case 1: "Acme Corp / John Smith" - PWD stage, in_progress
       - Case 2: "Tech Solutions / Maria Garcia" - Recruitment stage, in_progress
       - Case 3: "Global Inc / Wei Chen" - ETA 9089 stage, filed
       - Case 4: "Startup Labs / Raj Patel" - I-140 stage, pending
       - Case 5: "Enterprise Co / Anna Kowalski" - Complete (approved)

       Use actual PERM dates and calculations (import from @/lib/perm):
       - PWD determination → expiration (calculatePWDExpiration)
       - Recruitment start → end dates
       - Realistic deadline scenarios

    Note: Keep localStorage logic simple, don't overcomplicate.
  </action>
  <verify>pnpm build succeeds, unit test localStorage functions work</verify>
  <done>Demo localStorage utilities with 5 default cases, typed and tested</done>
</task>

<task type="auto">
  <name>Task 2: Build demo page layout with banner and stats grid</name>
  <files>v2/src/app/(public)/demo/page.tsx, v2/src/components/demo/DemoBanner.tsx, v2/src/components/demo/StatsGrid.tsx</files>
  <exploration>
    Review v1 demo.html for banner styling and stats structure.
    Check existing Card component for stats cards.
  </exploration>
  <action>
    1. Create DemoBanner.tsx:
       - Fixed position at top (below header)
       - Gradient background: green to blue (--primary to stage-pwd)
       - Text: "Demo Mode - Changes saved to this browser only"
       - Link: "Sign up for real account"
       - Z-index below header
       - Adjust body padding to account for banner height

    2. Create StatsGrid.tsx:
       - 4 stat cards in a row (2x2 on mobile)
       - Props: cases: DemoCase[]
       - Stats calculated from cases:
         - Total Cases: cases.length
         - Active Deadlines: count cases with upcoming deadlines
         - This Week: deadlines in next 7 days
         - Overdue: past deadlines
       - Each card: Value (large number) + Label (smaller text)
       - Use Card component with hover effect
       - Animate values on change (optional)

    3. Create demo/page.tsx:
       - "use client" (needs localStorage)
       - Import useDemoCases hook
       - Initialize demo cases on mount
       - Render DemoBanner at top
       - Render StatsGrid with cases
       - Placeholder sections for calendar, timeline, cases (25.2-05)
       - Reset button at bottom
  </action>
  <verify>Navigate to localhost:3000/demo, banner and stats visible</verify>
  <done>Demo page with banner and stats grid showing case counts</done>
</task>

<task type="auto">
  <name>Task 3: Build mini calendar and mini timeline components</name>
  <files>v2/src/components/demo/MiniCalendar.tsx, v2/src/components/demo/MiniTimeline.tsx</files>
  <exploration>
    Review v1 demo.html for mini-calendar and mini-timeline HTML/CSS.
    Check existing calendar component patterns (from Phase 23.1).
    Look at timeline milestone patterns from Phase 23.
  </exploration>
  <action>
    1. Create MiniCalendar.tsx:
       - Compact month view (current month)
       - 7-column grid (Sun-Sat headers)
       - Days with events show colored dot indicator
       - Today highlighted with primary color
       - Props: cases: DemoCase[], onDateClick?: (date: string) => void
       - Extract deadlines from cases using @/lib/perm utilities
       - Color-code dots by deadline type (PWD blue, recruitment purple, etc.)
       - Hover tooltip showing deadline details (optional)
       - Dark mode support

    2. Create MiniTimeline.tsx:
       - Vertical list of cases with progress bars
       - Props: cases: DemoCase[]
       - Each item shows:
         - Case name (beneficiary @ employer)
         - Progress bar (width based on stage completion %)
         - Status badge (use existing Badge component)
         - Stage color for progress bar
       - Calculate progress using isRecruitmentComplete, stage checks
       - Max 5 items shown (most recent or with nearest deadlines)
       - Compact styling to fit in grid cell

    3. Update demo/page.tsx:
       - Add preview grid section (2-column on desktop)
       - Left column: MiniCalendar
       - Right column: MiniTimeline
       - Both components receive demo cases from hook
  </action>
  <verify>Demo page shows mini calendar with event dots, mini timeline with progress bars</verify>
  <done>Mini calendar and timeline integrated into demo page</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Demo localStorage utilities in v2/src/lib/demo/
- [ ] 5 default demo cases with realistic PERM data
- [ ] useDemoCases hook working
- [ ] DemoBanner component with gradient
- [ ] StatsGrid with 4 stat cards
- [ ] MiniCalendar with event dots
- [ ] MiniTimeline with progress bars
- [ ] Demo page loads at /demo
- [ ] Dark mode works
- [ ] Mobile responsive
- [ ] pnpm build succeeds
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Demo page shows realistic PERM data
- localStorage persists between page reloads
- No TypeScript errors
- Uses existing UI components
</success_criteria>

<output>
After completion, create `.planning/phases/25.2-home-demo-page-polish/25.2-04-SUMMARY.md`:

# Phase 25.2 Plan 04: Demo Page Core Summary

**[Substantive one-liner - what shipped]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]
- [Key outcome 3]

## Files Created/Modified

- `path/to/file.ts` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 25.2-05-PLAN.md (Demo Page CRUD)
</output>
