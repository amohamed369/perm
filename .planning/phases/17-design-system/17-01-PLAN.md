---
phase: 17-design-system
plan: 01
type: execute
domain: frontend-design
---

<critical_requirement>
**MANDATORY SUBAGENT INSTRUCTION**: When using the Task tool to spawn ANY subagent for frontend/UI work in this plan, you MUST include this instruction in the subagent's prompt:

"BEFORE doing any work, you MUST read /Users/adammohamed/cc/perm-tracker-test/.planning/FRONTEND_DESIGN_SKILL.md in its entirety and apply all design principles from that document. This file contains critical design guidance for PERM Tracker v2 including neobrutalist styling, color tokens, and typography requirements. Do not proceed until you have read and internalized this skill."

This is a BLOCKING requirement. Every Task tool call for UI/frontend work must include this instruction.
</critical_requirement>

<objective>
Initialize design system foundation: dependencies, CSS theming, utilities, and providers.

Purpose: Establish the foundational layer that all UI components build upon - dependencies installed, CSS variables defined, theme provider configured, utility functions ready.
Output: Working theme system with light/dark mode, design tokens from V2_DESIGN_TOKENS.json, and shadcn/ui initialized.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/FRONTEND_DESIGN_SKILL.md
@.planning/V2_DESIGN_TOKENS.json
@.planning/phases/17-design-system/17-CONTEXT.md
@.planning/phases/17-design-system/17-RESEARCH.md

**Prior decisions affecting this phase:**
- Phase 15: Next.js 16.1.0 (not 15), Tailwind v4 CSS-first config
- Phase 15: TypeScript paths configured (`@/*` â†’ `./src/*`)
- Design tokens: Forest Green primary (#228B22), Space Grotesk + Inter fonts

**Codebase state:**
- v2/src/components/ does NOT exist yet
- v2/src/app/globals.css has basic Tailwind v4 setup with Geist fonts (to be replaced)
- No component libraries installed yet

**From RESEARCH.md:**
- Use shadcn/ui CLI 3.0 for component initialization
- Use `motion` package (NOT framer-motion)
- Use `next-themes` for dark mode
- Tailwind v4 requires `@theme inline` for CSS variable mapping
- Use `tw-animate-css` (NOT tailwindcss-animate)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install design system dependencies</name>
  <files>v2/package.json</files>
  <action>
Install required dependencies for the design system:

```bash
cd v2

# Animation libraries
npm install motion lottie-react

# Dark mode
npm install next-themes

# shadcn/ui utilities (will be used when components are added)
npm install class-variance-authority clsx tailwind-merge

# Animation CSS for Tailwind v4 (replaces tailwindcss-animate)
npm install tw-animate-css

# Google Fonts for Space Grotesk and Inter (via @next/font already included)
# Note: Fonts will be configured in layout.tsx
```

Verify package.json has all new dependencies.

**IMPORTANT:** Do NOT install framer-motion (deprecated). Use motion package.
  </action>
  <verify>npm ls motion lottie-react next-themes class-variance-authority clsx tailwind-merge tw-animate-css</verify>
  <done>All 7 dependencies installed and listed in package.json</done>
</task>

<task type="auto">
  <name>Task 2: Create utility functions and initialize shadcn/ui</name>
  <files>v2/src/lib/utils.ts, v2/components.json</files>
  <action>
Create the cn() utility function for class merging (required by all shadcn components):

```typescript
// v2/src/lib/utils.ts
import { type ClassValue, clsx } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}
```

Then run shadcn/ui init to generate components.json:

```bash
cd v2
npx shadcn@latest init
```

When prompted, select:
- TypeScript: yes
- Style: New York (more suited to neobrutalist)
- Base color: Neutral (we'll override with Forest Green)
- CSS variables: yes
- Path for components: @/components
- Path for utilities: @/lib/utils
- React Server Components: yes
- Use --force if needed

This creates `components.json` configuration file.
  </action>
  <verify>Test that files exist: ls -la v2/src/lib/utils.ts v2/components.json</verify>
  <done>cn() utility exists, components.json configured with correct paths</done>
</task>

<task type="auto">
  <name>Task 3: Configure CSS theme with design tokens</name>
  <files>v2/src/app/globals.css</files>
  <action>
Replace the current globals.css with the full neobrutalist theme from RESEARCH.md code examples.

Key requirements:
1. Import tailwindcss and tw-animate-css
2. Define :root variables for light mode (from V2_DESIGN_TOKENS.json)
3. Define .dark variables for dark mode
4. Add @theme inline block mapping CSS vars to Tailwind
5. Include stage colors (pwd, recruitment, eta9089, i140, closed)
6. Include urgency colors (urgent, soon, normal)
7. Add hard shadow utilities (.shadow-hard-sm, .shadow-hard, .shadow-hard-lg)
8. Configure base typography with Space Grotesk for headings, Inter for body

Use the exact globals.css from RESEARCH.md `<code_examples>` section as the template.

**CRITICAL values from V2_DESIGN_TOKENS.json:**
- Primary: #228B22 (Forest Green light), #2ECC40 (dark)
- Background: #FAFAFA (light), #1A1A1A (dark)
- Border: #000000 (light), #FAFAFA (dark)
- Stage PWD: #0066FF
- Stage Recruitment: #9333ea
- Stage ETA 9089: #D97706
- Stage I-140: #059669
- Stage Closed: #6B7280
- Hard shadow: 4px 4px 0px #000
- Border radius: 6px
  </action>
  <verify>Read v2/src/app/globals.css and verify all CSS variables are defined (grep for --stage-pwd, --shadow-hard, --primary)</verify>
  <done>globals.css contains all design tokens, light/dark themes, and @theme inline mappings</done>
</task>

<task type="auto">
  <name>Task 4: Create ThemeProvider and update layout</name>
  <files>v2/src/components/providers/theme-provider.tsx, v2/src/app/providers.tsx, v2/src/app/layout.tsx</files>
  <action>
Create the theme provider component:

```typescript
// v2/src/components/providers/theme-provider.tsx
"use client"

import * as React from "react"
import { ThemeProvider as NextThemesProvider } from "next-themes"

export function ThemeProvider({
  children,
  ...props
}: React.ComponentProps<typeof NextThemesProvider>) {
  return (
    <NextThemesProvider
      attribute="class"
      defaultTheme="system"
      enableSystem
      disableTransitionOnChange
      {...props}
    >
      {children}
    </NextThemesProvider>
  )
}
```

Update v2/src/app/providers.tsx to include ThemeProvider (wrapping ConvexClientProvider).

Update v2/src/app/layout.tsx:
1. Import Space Grotesk and Inter from next/font/google
2. Apply font classes to body
3. Wrap children with providers (Convex + Theme)
4. Update metadata title to "PERM Tracker"

**Font configuration:**
```typescript
import { Space_Grotesk, Inter } from "next/font/google"

const spaceGrotesk = Space_Grotesk({
  subsets: ["latin"],
  variable: "--font-heading",
})

const inter = Inter({
  subsets: ["latin"],
  variable: "--font-body",
})
```

Apply classes: `${spaceGrotesk.variable} ${inter.variable} font-body`
  </action>
  <verify>npm run dev, visit localhost:3000, check that dark mode toggle works by adding .dark to html element in devtools</verify>
  <done>ThemeProvider wraps app, fonts loaded (Space Grotesk + Inter), dark mode functional</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Dark mode works (adding .dark class to html changes colors)
- [ ] CSS variables visible in browser devtools (:root has --primary, --stage-pwd, etc.)
- [ ] Fonts load correctly (Space Grotesk for headings, Inter for body)
- [ ] No TypeScript errors
</verification>

<success_criteria>
- All dependencies installed
- cn() utility function exists
- components.json configured for shadcn/ui
- globals.css has complete design token system
- ThemeProvider configured with next-themes
- Fonts (Space Grotesk, Inter) loading via next/font
- Build passes
</success_criteria>

<output>
After completion, create `.planning/phases/17-design-system/17-01-SUMMARY.md`
</output>
