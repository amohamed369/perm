# V2 Field Mappings: PostgreSQL → Convex

**Purpose:** Complete field-by-field mapping from v1 (PostgreSQL/snake_case) to v2 (Convex/camelCase)

**Created:** 2025-12-20
**Status:** Reference Document

---

## Type Transformation Rules

| v1 Type | v2 Type | Transformation | Example |
|---------|---------|----------------|---------|
| `UUID` (PK) | `Id<"tableName">` | Auto-generated by Convex | `id` → `_id` |
| `UUID` (FK) | `Id<"tableName">` | Reference to Convex document | `user_id` → `userId: Id<"users">` |
| `DATE` | `string` | ISO 8601 YYYY-MM-DD | `"2024-03-15"` |
| `TIMESTAMP` | `number` | Unix milliseconds | `Date.now()` → `1710518400000` |
| `DECIMAL(10,2)` | `v.int64()` | Store as cents (×100) | `50000.00` → `5000000` |
| `TEXT` | `v.string()` | Direct mapping | `"Attorney"` |
| `BOOLEAN` | `v.boolean()` | Direct mapping | `true` |
| `JSONB` (array) | `v.array()` | Typed arrays | `["tag1", "tag2"]` |
| `JSONB` (object) | `v.object()` | Typed objects | `{key: "value"}` |
| `VARCHAR(255)` | `v.string()` | Direct mapping | `"email@example.com"` |

---

## Table: `cases` → `cases`

**Primary business entity - PERM case tracking**

### Core Identification

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `id` | `_id` | `Id<"cases">` | Auto-generated |
| `user_id` | `userId` | `Id<"users">` | FK reference |
| `case_number` | `caseNumber` | `v.string()` | Optional |
| `employer_name` | `employerName` | `v.string()` | Required |
| `position_title` | `positionTitle` | `v.string()` | Required |
| `beneficiary_identifier` | `beneficiaryIdentifier` | `v.string()` | Required |

### PWD Stage (6 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `pwd_filing_date` | `pwdFilingDate` | `v.optional(v.string())` | ISO 8601 |
| `pwd_determination_date` | `pwdDeterminationDate` | `v.optional(v.string())` | ISO 8601 |
| `pwd_expiration_date` | `pwdExpirationDate` | `v.optional(v.string())` | ISO 8601, calculated |
| `pwd_wage_amount` | `pwdWageAmount` | `v.optional(v.int64())` | Cents (×100) |
| `pwd_wage_level` | `pwdWageLevel` | `v.optional(v.string())` | "I", "II", "III", "IV" |
| `pwd_case_number` | `pwdCaseNumber` | `v.optional(v.string())` | |

### Recruitment Stage (12 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `job_order_start_date` | `jobOrderStartDate` | `v.optional(v.string())` | ISO 8601 |
| `job_order_end_date` | `jobOrderEndDate` | `v.optional(v.string())` | ISO 8601, calculated +30 days |
| `job_order_state` | `jobOrderState` | `v.optional(v.string())` | US state code |
| `sunday_ad_first_date` | `sundayAdFirstDate` | `v.optional(v.string())` | ISO 8601, must be Sunday |
| `sunday_ad_second_date` | `sundayAdSecondDate` | `v.optional(v.string())` | ISO 8601, must be Sunday |
| `sunday_ad_newspaper` | `sundayAdNewspaper` | `v.optional(v.string())` | Newspaper name |
| `notice_of_filing_start_date` | `noticeOfFilingStartDate` | `v.optional(v.string())` | ISO 8601 |
| `notice_of_filing_end_date` | `noticeOfFilingEndDate` | `v.optional(v.string())` | ISO 8601, calculated +10 days |
| `additional_recruitment_methods` | `additionalRecruitmentMethods` | `v.optional(v.array(v.string()))` | Array of methods |
| `recruitment_applicants_count` | `recruitmentApplicantsCount` | `v.number()` | Default: 0 |
| `recruitment_summary_custom` | `recruitmentSummaryCustom` | `v.optional(v.string())` | Long text |
| `recruitment_end_date` | `recruitmentEndDate` | `v.optional(v.string())` | ISO 8601, calculated |

### ETA 9089 Stage (4 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `eta9089_filing_date` | `eta9089FilingDate` | `v.optional(v.string())` | ISO 8601 |
| `eta9089_certification_date` | `eta9089CertificationDate` | `v.optional(v.string())` | ISO 8601 |
| `eta9089_expiration_date` | `eta9089ExpirationDate` | `v.optional(v.string())` | ISO 8601, calculated +180 days |
| `eta9089_case_number` | `eta9089CaseNumber` | `v.optional(v.string())` | |

### RFI Stage (6 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `rfi_received_date` | `rfiReceivedDate` | `v.optional(v.string())` | ISO 8601 |
| `rfi_response_due_date` | `rfiResponseDueDate` | `v.optional(v.string())` | ISO 8601 |
| `rfi_response_submitted_date` | `rfiResponseSubmittedDate` | `v.optional(v.string())` | ISO 8601 |
| `rfi_list` | `rfiList` | `v.optional(v.array(v.string()))` | Array of RFI items |
| `rfi_notes` | `rfiNotes` | `v.optional(v.string())` | Long text |
| `rfi_documents` | `rfiDocuments` | `v.optional(v.array(v.object({...})))` | Document metadata |

### RFE Stage (6 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `rfe_received_date` | `rfeReceivedDate` | `v.optional(v.string())` | ISO 8601 |
| `rfe_response_due_date` | `rfeResponseDueDate` | `v.optional(v.string())` | ISO 8601 |
| `rfe_response_submitted_date` | `rfeResponseSubmittedDate` | `v.optional(v.string())` | ISO 8601 |
| `rfe_list` | `rfeList` | `v.optional(v.array(v.string()))` | Array of RFE items |
| `rfe_notes` | `rfeNotes` | `v.optional(v.string())` | Long text |
| `rfe_documents` | `rfeDocuments` | `v.optional(v.array(v.object({...})))` | Document metadata |

### I-140 Stage (3 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `i140_filing_date` | `i140FilingDate` | `v.optional(v.string())` | ISO 8601 |
| `i140_approval_date` | `i140ApprovalDate` | `v.optional(v.string())` | ISO 8601 |
| `i140_receipt_number` | `i140ReceiptNumber` | `v.optional(v.string())` | |

### Status & Classification (4 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `case_status` | `caseStatus` | `v.string()` | Enum: "active", "withdrawn", "denied", "certified", "approved" |
| `progress_status` | `progressStatus` | `v.string()` | Enum: "pwd", "recruitment", "eta9089", "i140", "completed" |
| `is_professional_occupation` | `isProfessionalOccupation` | `v.boolean()` | Default: false |
| `priority_level` | `priorityLevel` | `v.optional(v.string())` | "low", "medium", "high", "urgent" |

### User Metadata (5 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `is_favorite` | `isFavorite` | `v.boolean()` | Default: false |
| `notes` | `notes` | `v.optional(v.string())` | Long text |
| `tags` | `tags` | `v.optional(v.array(v.string()))` | Array of tags |
| `documents` | `documents` | `v.optional(v.array(v.object({...})))` | Document metadata |
| `calendar_sync_enabled` | `calendarSyncEnabled` | `v.boolean()` | Default: true |

### Calendar Integration (1 field)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `calendar_event_ids` | `calendarEventIds` | `v.optional(v.array(v.string()))` | Google Calendar event IDs |

### Timestamps (5 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `created_at` | `_creationTime` | `v.number()` | Auto-generated by Convex |
| `updated_at` | `updatedAt` | `v.number()` | Unix ms, maintained manually |
| `deleted_at` | `deletedAt` | `v.optional(v.number())` | Soft delete timestamp |

**Total Fields:** 50+ mapped

---

## Table: `users` → `users`

**User accounts and authentication**

### Core Identity (8 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `id` | `_id` | `Id<"users">` | Auto-generated |
| `email` | `email` | `v.string()` | Unique, required |
| `full_name` | `fullName` | `v.optional(v.string())` | |
| `phone` | `phone` | `v.optional(v.string())` | |
| `job_title` | `jobTitle` | `v.optional(v.string())` | |
| `company` | `company` | `v.optional(v.string())` | |
| `profile_photo_url` | `profilePhotoUrl` | `v.optional(v.string())` | |
| `user_type` | `userType` | `v.string()` | "attorney", "paralegal", "admin" |

### OAuth & Authentication (2 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `oauth_provider` | `oauthProvider` | `v.optional(v.string())` | "google" |
| `last_login` | `lastLogin` | `v.optional(v.number())` | Unix ms |

### Firm Affiliation (2 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `firm_id` | `firmId` | `v.optional(v.string())` | Future: Id<"firms"> |
| `firm_name` | `firmName` | `v.optional(v.string())` | |

### Notification Preferences (4 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `notification_email` | `notificationEmail` | `v.optional(v.string())` | Override email |
| `notification_sms` | `notificationSms` | `v.boolean()` | Default: false |
| `notification_push` | `notificationPush` | `v.boolean()` | Default: true |
| `urgent_deadline_days` | `urgentDeadlineDays` | `v.number()` | Default: 7 |

### Privacy & Settings (2 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `privacy_mode_enabled` | `privacyModeEnabled` | `v.boolean()` | Default: false |
| `calendar_sync_enabled` | `calendarSyncEnabled` | `v.boolean()` | Default: true |

### Calendar Sync Toggles (7 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `calendar_sync_pwd` | `calendarSyncPwd` | `v.boolean()` | Default: true |
| `calendar_sync_eta9089` | `calendarSyncEta9089` | `v.boolean()` | Default: true |
| `calendar_sync_i140` | `calendarSyncI140` | `v.boolean()` | Default: true |
| `calendar_sync_rfe` | `calendarSyncRfe` | `v.boolean()` | Default: true |
| `calendar_sync_rfi` | `calendarSyncRfi` | `v.boolean()` | Default: true |
| `calendar_sync_recruitment` | `calendarSyncRecruitment` | `v.boolean()` | Default: true |
| `calendar_sync_filing_window` | `calendarSyncFilingWindow` | `v.boolean()` | Default: true |

### Google OAuth Tokens (7 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `google_refresh_token` | `googleRefreshToken` | `v.optional(v.string())` | Encrypted |
| `google_access_token` | `googleAccessToken` | `v.optional(v.string())` | Encrypted |
| `google_token_expiry` | `googleTokenExpiry` | `v.optional(v.number())` | Unix ms |
| `google_scopes` | `googleScopes` | `v.optional(v.array(v.string()))` | OAuth scopes |
| `google_email` | `googleEmail` | `v.optional(v.string())` | |
| `gmail_connected` | `gmailConnected` | `v.boolean()` | Default: false |
| `calendar_connected` | `calendarConnected` | `v.boolean()` | Default: false |

### Timestamps (4 fields)

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `created_at` | `_creationTime` | `v.number()` | Auto-generated |
| `updated_at` | `updatedAt` | `v.number()` | Unix ms |
| `deleted_at` | `deletedAt` | `v.optional(v.number())` | Soft delete |

**Total Fields:** 36 mapped

---

## Table: `notifications` → `notifications`

**User notifications for deadlines and updates**

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `id` | `_id` | `Id<"notifications">` | Auto-generated |
| `user_id` | `userId` | `Id<"users">` | FK reference |
| `case_id` | `caseId` | `v.optional(Id<"cases">)` | FK reference |
| `type` | `type` | `v.string()` | "deadline", "status_update", "rfe_alert" |
| `title` | `title` | `v.string()` | Required |
| `message` | `message` | `v.string()` | Required |
| `priority` | `priority` | `v.string()` | "low", "medium", "high", "urgent" |
| `deadline_date` | `deadlineDate` | `v.optional(v.string())` | ISO 8601 |
| `deadline_type` | `deadlineType` | `v.optional(v.string())` | "pwd", "eta9089", "rfe", etc. |
| `days_until_deadline` | `daysUntilDeadline` | `v.optional(v.number())` | Calculated |
| `is_read` | `isRead` | `v.boolean()` | Default: false |
| `read_at` | `readAt` | `v.optional(v.number())` | Unix ms |
| `email_sent` | `emailSent` | `v.boolean()` | Default: false |
| `email_sent_at` | `emailSentAt` | `v.optional(v.number())` | Unix ms |
| `created_at` | `_creationTime` | `v.number()` | Auto-generated |
| `updated_at` | `updatedAt` | `v.number()` | Unix ms |

**Total Fields:** 16 mapped

---

## Table: `user_settings` → `userSettings`

**User-specific notification and reminder settings**

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `id` | `_id` | `Id<"userSettings">` | Auto-generated |
| `user_id` | `userId` | `Id<"users">` | FK reference, unique |
| `email_notifications_enabled` | `emailNotificationsEnabled` | `v.boolean()` | Default: true |
| `email_deadline_reminders` | `emailDeadlineReminders` | `v.boolean()` | Default: true |
| `email_status_updates` | `emailStatusUpdates` | `v.boolean()` | Default: true |
| `email_rfe_alerts` | `emailRfeAlerts` | `v.boolean()` | Default: true |
| `reminder_days_before` | `reminderDaysBefore` | `v.number()` | Default: 7 |
| `quiet_hours_enabled` | `quietHoursEnabled` | `v.boolean()` | Default: false |
| `quiet_hours_start` | `quietHoursStart` | `v.optional(v.string())` | "HH:MM" format |
| `quiet_hours_end` | `quietHoursEnd` | `v.optional(v.string())` | "HH:MM" format |
| `timezone` | `timezone` | `v.string()` | IANA timezone, default: "America/New_York" |
| `preferred_notification_email` | `preferredNotificationEmail` | `v.optional(v.string())` | |
| `created_at` | `_creationTime` | `v.number()` | Auto-generated |
| `updated_at` | `updatedAt` | `v.number()` | Unix ms |

**Total Fields:** 14 mapped

---

## Table: `user_preferences` → `userPreferences`

**UI preferences and dismissed items**

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `id` | `_id` | `Id<"userPreferences">` | Auto-generated |
| `user_id` | `userId` | `Id<"users">` | FK reference, unique |
| `cases_sort_by` | `casesSortBy` | `v.string()` | Default: "created_at" |
| `cases_sort_order` | `casesSortOrder` | `v.string()` | Default: "desc" |
| `cases_per_page` | `casesPerPage` | `v.number()` | Default: 25 |
| `dismissed_deadlines` | `dismissedDeadlines` | `v.array(v.string())` | Array of deadline IDs |
| `created_at` | `_creationTime` | `v.number()` | Auto-generated |
| `updated_at` | `updatedAt` | `v.number()` | Unix ms |

**Total Fields:** 8 mapped

---

## Table: `refresh_tokens` → `refreshTokens`

**JWT refresh tokens for authentication**

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `id` | `_id` | `Id<"refreshTokens">` | Auto-generated |
| `user_id` | `userId` | `Id<"users">` | FK reference |
| `token` | `token` | `v.string()` | Hashed token |
| `expires_at` | `expiresAt` | `v.number()` | Unix ms |
| `revoked_at` | `revokedAt` | `v.optional(v.number())` | Unix ms |
| `revoked_reason` | `revokedReason` | `v.optional(v.string())` | |
| `ip_address` | `ipAddress` | `v.optional(v.string())` | |
| `user_agent` | `userAgent` | `v.optional(v.string())` | |
| `created_at` | `_creationTime` | `v.number()` | Auto-generated |
| `updated_at` | `updatedAt` | `v.number()` | Unix ms |

**Total Fields:** 10 mapped

---

## Table: `conversations` → `conversations`

**Chatbot conversation threads**

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `id` | `_id` | `Id<"conversations">` | Auto-generated |
| `user_id` | `userId` | `Id<"users">` | FK reference |
| `title` | `title` | `v.string()` | Required |
| `is_archived` | `isArchived` | `v.boolean()` | Default: false |
| `metadata` | `metadata` | `v.optional(v.object({...}))` | Flexible JSON |
| `created_at` | `_creationTime` | `v.number()` | Auto-generated |
| `updated_at` | `updatedAt` | `v.number()` | Unix ms |

**Total Fields:** 7 mapped

---

## Table: `conversation_messages` → `conversationMessages`

**Individual messages in chatbot conversations**

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `id` | `_id` | `Id<"conversationMessages">` | Auto-generated |
| `conversation_id` | `conversationId` | `Id<"conversations">` | FK reference |
| `role` | `role` | `v.string()` | "user", "assistant", "system" |
| `content` | `content` | `v.string()` | Required |
| `tool_calls` | `toolCalls` | `v.optional(v.array(v.object({...})))` | LLM tool calls |
| `metadata` | `metadata` | `v.optional(v.object({...}))` | Flexible JSON |
| `created_at` | `_creationTime` | `v.number()` | Auto-generated |

**Total Fields:** 7 mapped

---

## Table: `permission_states` → `permissionStates`

**Temporary permission state for chatbot approval workflows**

| v1 Field | v2 Field | v2 Type | Notes |
|----------|----------|---------|-------|
| `state_id` | `stateId` | `v.string()` | UUID, unique |
| `user_id` | `userId` | `Id<"users">` | FK reference |
| `conversation_id` | `conversationId` | `Id<"conversations">` | FK reference |
| `messages` | `messages` | `v.array(v.object({...}))` | Conversation history |
| `pending_tool_call` | `pendingToolCall` | `v.object({...})` | Tool awaiting approval |
| `tools_executed` | `toolsExecuted` | `v.array(v.object({...}))` | Previously executed |
| `expires_at` | `expiresAt` | `v.number()` | Unix ms |
| `created_at` | `_creationTime` | `v.number()` | Auto-generated |

**Total Fields:** 8 mapped

---

## Migration Example Code

### PostgreSQL to Convex Data Transformation

```typescript
// Example: Migrating a case from PostgreSQL to Convex
async function migrateCaseToConvex(pgCase: any) {
  return {
    // ID transformation
    userId: await resolveUserId(pgCase.user_id), // UUID → Id<"users">

    // Core fields (direct mapping)
    employerName: pgCase.employer_name,
    positionTitle: pgCase.position_title,
    beneficiaryIdentifier: pgCase.beneficiary_identifier,
    caseNumber: pgCase.case_number || undefined,

    // Date fields (DATE → ISO string)
    pwdFilingDate: pgCase.pwd_filing_date?.toISOString().split('T')[0],
    pwdDeterminationDate: pgCase.pwd_determination_date?.toISOString().split('T')[0],

    // Timestamp fields (TIMESTAMP → Unix ms)
    updatedAt: pgCase.updated_at?.getTime() || Date.now(),
    deletedAt: pgCase.deleted_at?.getTime() || undefined,

    // Money fields (DECIMAL → cents as int64)
    pwdWageAmount: pgCase.pwd_wage_amount
      ? Math.round(parseFloat(pgCase.pwd_wage_amount) * 100)
      : undefined,

    // Boolean fields (direct mapping with defaults)
    isProfessionalOccupation: pgCase.is_professional_occupation ?? false,
    isFavorite: pgCase.is_favorite ?? false,
    calendarSyncEnabled: pgCase.calendar_sync_enabled ?? true,

    // Array fields (JSONB → typed arrays)
    tags: pgCase.tags || [],
    calendarEventIds: pgCase.calendar_event_ids || [],
    additionalRecruitmentMethods: pgCase.additional_recruitment_methods || [],

    // Object fields (JSONB → typed objects)
    documents: pgCase.documents || [],

    // Numeric fields
    recruitmentApplicantsCount: pgCase.recruitment_applicants_count ?? 0,
  };
}
```

### Reverse: Convex to API Response

```typescript
// Example: Converting Convex document to API response
function convexCaseToApiResponse(convexCase: Doc<"cases">) {
  return {
    id: convexCase._id,
    user_id: convexCase.userId,

    // Dates (ISO string → keep as string)
    pwd_filing_date: convexCase.pwdFilingDate,
    pwd_determination_date: convexCase.pwdDeterminationDate,

    // Timestamps (Unix ms → ISO string for API)
    created_at: new Date(convexCase._creationTime).toISOString(),
    updated_at: new Date(convexCase.updatedAt).toISOString(),

    // Money (cents → decimal string)
    pwd_wage_amount: convexCase.pwdWageAmount
      ? (convexCase.pwdWageAmount / 100).toFixed(2)
      : null,

    // Direct mappings
    employer_name: convexCase.employerName,
    position_title: convexCase.positionTitle,
    is_favorite: convexCase.isFavorite,
    tags: convexCase.tags,
  };
}
```

---

## Boolean Field Defaults

**Default: `true`**
- `calendarSyncEnabled` (users, cases)
- `calendarSyncPwd` (users)
- `calendarSyncEta9089` (users)
- `calendarSyncI140` (users)
- `calendarSyncRfe` (users)
- `calendarSyncRfi` (users)
- `calendarSyncRecruitment` (users)
- `calendarSyncFilingWindow` (users)
- `emailNotificationsEnabled` (userSettings)
- `emailDeadlineReminders` (userSettings)
- `emailStatusUpdates` (userSettings)
- `emailRfeAlerts` (userSettings)
- `notificationPush` (users)

**Default: `false`**
- `isProfessionalOccupation` (cases)
- `isFavorite` (cases)
- `privacyModeEnabled` (users)
- `notificationSms` (users)
- `quietHoursEnabled` (userSettings)
- `isArchived` (conversations)
- `isRead` (notifications)
- `emailSent` (notifications)
- `gmailConnected` (users)
- `calendarConnected` (users)

**Default: numeric**
- `recruitmentApplicantsCount`: 0
- `urgentDeadlineDays`: 7
- `reminderDaysBefore`: 7
- `casesPerPage`: 25

**Default: string**
- `timezone`: "America/New_York"
- `casesSortBy`: "created_at"
- `casesSortOrder`: "desc"

---

## Document Metadata Object Schema

**Used in:** `cases.documents`, `cases.rfiDocuments`, `cases.rfeDocuments`

```typescript
v.object({
  id: v.string(),          // Unique document ID
  name: v.string(),        // Filename
  url: v.string(),         // Storage URL
  size: v.number(),        // Bytes
  mimeType: v.string(),    // MIME type
  uploadedAt: v.number(),  // Unix ms
  category: v.optional(v.string()), // "pwd", "recruitment", etc.
})
```

---

## Summary Statistics

| Table | v1 Fields | v2 Fields | Notes |
|-------|-----------|-----------|-------|
| cases | 50+ | 50+ | Most complex table |
| users | 36 | 36 | Google OAuth integration |
| notifications | 16 | 16 | Deadline alerts |
| userSettings | 14 | 14 | Notification preferences |
| userPreferences | 8 | 8 | UI preferences |
| refreshTokens | 10 | 10 | Auth tokens |
| conversations | 7 | 7 | Chatbot threads |
| conversationMessages | 7 | 7 | Chat messages |
| permissionStates | 8 | 8 | Approval workflow |

**Total:** 9 tables, 156+ fields mapped

---

## Next Steps

1. **Phase 13**: Implement Convex schema using these mappings
2. **Phase 14**: Write migration script to transform PostgreSQL → Convex
3. **Phase 15**: Update API layer to use Convex SDK
4. **Phase 16**: Update frontend to use new API responses

**References:**
- See `.planning/V2_CONVEX_SCHEMA.md` for complete Convex schema
- See `.planning/V2_BUSINESS_RULES.md` for validation logic
- See `.planning/V2_DEADLINE_FLOWS.md` for date calculations
